# 漏洞挖掘系统开发文档

## 用户管理

用户实体拥有的属性是：

1. 名称（username）：用户的名称。
2. 身份标识符（id）：用户的唯一标识符。
3. 密码（password）：用于登录，存储明文密码的哈希值。
4. 邮箱（email）：用于密码找回。
5. 测试用例组（test_case_groups）：测试用例组由多个测试用例组成。一个用户可拥有多个测试用例组，同时一个测试用例组唯一对应一个用户。
6. 测试套件（test_suites）：测试套件由多个测试用例组成。一个用户可拥有多个测试套件，一个测试套件由多个测试用例组成。
7. 角色（role）：标识用户在系统中的权限等级。
8. 禁用（disable）：标识用户是否被禁用，用于多次登录错误的情况。

### 用户注册

- 用户传入名称、密码、邮箱完成注册。

1. 根据名称查询数据库，判断用户是否已经存在，存在返回错误
2. 否则将用户信息加入 Users 表
3. 日志记录用户注册操作
4. 向客户端响应注册成功

### 用户登录

- 用户传入名称和密码完成登录。

1. 根据用户名查询数据库判断用户是否存在，不存在则返回用户不存在。
2. 否则获取对应用户的密码哈希值，同时将传入的密码进行哈希，最后比较两个哈希后的密码，不相等则返回账号或密码错误。
3. 否则创建身份认证 token。
4. 向客户端返回 token，并提示登录成功。

## 模糊测试管理

模糊测试用例实体拥有的属性是：

1. 名称（name）：测试用例的名称。
2. 测试用例 id（test_case_id）：测试用例的唯一标识符。
3. 描述（desc）：对测试用例的描述。
4. 长度（size）：指示测试用例占据的比特/字节数。
5. 单位（unit）：比特或字节
6. 默认值（default_value）：测试用例的默认值。
7. 字节顺序（endian）：测试用例的字节顺序，大端用 `>` 表示，小端用 `<` 表示。
8. 变异规则（fuzzable）：表示是否要对用例进行模糊测试，用 `True` 或 `False` 表示。
9. 父节点（parent_id）：用于测试用例的嵌套

### 测试用例库读取

1. 利用 `token` 判断用户是否登录。如果用户未登录或者登录 token 已过期，那么响应未登录并跳转登录页面。
2. 否则从 jwt 中提取用户信息并查询数据库，查询用户的测试用例组。
3. 返回系统默认用例组和用户自定义用例组

### 测试用例组创建

传入组名（str）创建测试用例组


1. 利用 `token` 判断用户是否登录。如果用户未登录或者登录 token 已过期，那么响应未登录并跳转登录页面。
2. 否则根据组名向测试用例组表插入一条记录。
3. 向客户端响应创建成功

### 自定义测试用例

传入：

1. 测试用例组名
2. 测试用例名
3. 测试用例描述
4. 默认值
5. 长度
6. 变异规则
7. 单位

操作：

1. 根据上述 2-7 步的信息向测试用例表插入一条记录。
2. 根据组名，将刚刚插入的测试用例记录插入对应的用例组表。
3. 响应自定义测试用例成功

### 测试套件设置

- 根据传入的测试用例组的名称和测试用例的名称，寻找特定的测试用例并将其添加到测试套件中。

操作：

1. 从 token 提取用户信息查询数据库获取对应用户。
2. 根据名称查询该用户的测试用例组。
3. 再根据测试用例的名称查询该组中对应的测试用例。
4. 将查询得到的测试用例加入该用户的测试套件模板库中。

## 日志管理

记录用户的操作信息
